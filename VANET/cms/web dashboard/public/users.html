<!doctype html><html><head><meta charset="utf-8"><title>Users</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"></head><body class="p-4"><div class="container"><h3>Users</h3><div class="card p-3 mb-3"><form id="addUserForm" class="row g-2"><div class="col-md-4"><input id="newUser" class="form-control" placeholder="username"></div><div class="col-md-4"><input id="newPass" type="password" class="form-control" placeholder="password"></div><div class="col-md-2"><select id="newRole" class="form-select"><option value="operator">Operator</option><option value="admin">Admin</option></select></div><div class="col-md-2"><button class="btn btn-primary w-100">Add User</button></div></form></div><div class="card p-3"><table class="table" id="usersTable"><thead><tr><th>ID</th><th>Username</th><th>Role</th><th>Action</th></tr></thead><tbody></tbody></table></div><a href='/index.html' class='btn btn-link mt-3'>‚Üê Back</a></div><script src='/assets/js/app.js'></script><script>async function apiFetch(path, opts){opts=opts||{};opts.headers=opts.headers||{};const t=localStorage.getItem('vanet_token');if(t) opts.headers['Authorization']='Bearer '+t; if(opts.body && typeof opts.body!=='string') opts.body=JSON.stringify(opts.body); if(opts.body) opts.headers['Content-Type']='application/json'; const r=await fetch(path, opts); if(r.status===401){alert('Not authorized - login'); window.location='/login.html';} return r;} async function loadUsers(){ const r=await apiFetch('/api/users',{method:'GET'}); if(!r.ok) {alert('Failed to load users'); return;} const j=await r.json(); const tbody=document.querySelector('#usersTable tbody'); tbody.innerHTML=''; j.forEach(u=>{ const tr=document.createElement('tr'); tr.innerHTML = `<td>${u.id}</td><td>${u.username}</td><td>${u.role}</td><td><button class='btn btn-sm btn-danger' onclick='delUser(${u.id})'>Delete</button></td>`; tbody.appendChild(tr); }); } async function delUser(id){ if(!confirm('Delete user?')) return; const r=await apiFetch('/api/users/'+id,{method:'DELETE'}); if(r.ok) loadUsers(); else alert('Failed'); } document.getElementById('addUserForm').addEventListener('submit', async (e)=>{ e.preventDefault(); const username=document.getElementById('newUser').value; const password=document.getElementById('newPass').value; const role=document.getElementById('newRole').value; const r=await apiFetch('/api/users',{method:'POST', body:{username,password,role}}); if(r.ok){ document.getElementById('newUser').value=''; document.getElementById('newPass').value=''; loadUsers(); } else alert('Failed'); }); loadUsers();</script></body></html>